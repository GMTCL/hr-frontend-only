(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9853],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},854:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(2115);function r(){let[e,t]=(0,s.useState)({loading:!1,error:null,user:null,isAuthenticated:!1}),a=(0,s.useCallback)(async(e,a)=>{t(e=>({...e,loading:!0,error:null}));try{if(await new Promise(e=>setTimeout(e,1e3)),"admin@hr.com"!==e||"password"!==a)return t(e=>({...e,loading:!1,error:"อีเมลหรือรหัสผ่านไม่ถูกต้อง"})),{success:!1,error:"อีเมลหรือรหัสผ่านไม่ถูกต้อง"};{let a={id:1,email:e,name:"HR Admin",role:"admin"};return t({loading:!1,error:null,user:a,isAuthenticated:!0}),{success:!0,user:a}}}catch(a){let e="เกิดข้อผิดพลาดในการเข้าสู่ระบบ";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},[]),r=(0,s.useCallback)(()=>{t({loading:!1,error:null,user:null,isAuthenticated:!1})},[]),n=(0,s.useCallback)(()=>{t(e=>({...e,error:null}))},[]);return{...e,login:a,logout:r,clearError:n}}},960:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>i,Gt:()=>o,Rz:()=>n,Wp:()=>d,aq:()=>c,ug:()=>l});let s=()=>localStorage.getItem("authToken"),r=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a="".concat("https://hrbackoofice.mimshack-sourc.com/api").concat(e),r=(()=>{let e=s(),t={"Content-Type":"application/json",Accept:"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t})(),n=await fetch(a,{...t,headers:{...r,...t.headers}}),c=await n.json();if(!n.ok)throw Error(c.message||"HTTP error! status: ".concat(n.status));return{success:!0,data:c.data||c,message:c.message}}catch(t){return console.error("API request failed for ".concat(e,":"),t),{success:!1,message:t instanceof Error?t.message:"An unknown error occurred",errors:t}}},n={getAll:async()=>r("/employees"),getById:async e=>r("/employees/".concat(e)),create:async e=>r("/employees",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>r("/employees/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>r("/employees/".concat(e),{method:"DELETE"})},c={getAll:async()=>r("/leave-requests"),getById:async e=>r("/leave-requests/".concat(e)),create:async e=>r("/leave-requests",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>r("/leave-requests/".concat(e),{method:"PUT",body:JSON.stringify(t)}),approve:async e=>r("/leave-requests/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:"approved"})}),reject:async(e,t)=>r("/leave-requests/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:"rejected",reason:t})})},o={clockIn:async e=>r("/attendance/clock-in",{method:"POST",body:JSON.stringify({employee_id:e})}),clockOut:async e=>r("/attendance/clock-out",{method:"POST",body:JSON.stringify({employee_id:e})}),getAttendance:async(e,t)=>r(t?"/attendance?employee_id=".concat(e,"&date=").concat(t):"/attendance?employee_id=".concat(e)),getAttendanceReport:async(e,t)=>r("/attendance/summary?start_date=".concat(e,"&end_date=").concat(t))},l={getEmployeeReport:async()=>r("/reports/employees"),getAttendanceReport:async(e,t)=>r("/reports/attendance?start_date=".concat(e,"&end_date=").concat(t)),getPayrollReport:async e=>r("/reports/payroll?period=".concat(e)),getLeaveReport:async()=>r("/reports/leaves"),exportReport:async(e,t)=>r("/reports/".concat(e,"/export?format=").concat(t))},i={auth:{login:async e=>r("/auth/login",{method:"POST",body:JSON.stringify(e)}),logout:async()=>r("/auth/logout",{method:"POST"}),me:async()=>r("/auth/profile")},employee:n,department:{getAll:async()=>r("/departments"),getById:async e=>r("/departments/".concat(e)),create:async e=>r("/departments",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>r("/departments/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>r("/departments/".concat(e),{method:"DELETE"})},leave:c,attendance:o,payroll:{getAll:async()=>r("/payroll"),getById:async e=>r("/payroll/".concat(e)),process:async e=>r("/payroll/generate",{method:"POST",body:JSON.stringify({payroll_data:e})}),generateSlip:async(e,t)=>r("/payroll/export?period=".concat(encodeURIComponent(t)))},reports:l,performance:{getReviews:async e=>r(e?"/performance/reviews/".concat(e):"/performance/reviews"),createReview:async e=>r("/performance/reviews",{method:"POST",body:JSON.stringify(e)}),getGoals:async e=>r(e?"/performance/goals/".concat(e):"/performance/goals"),setGoal:async e=>r("/performance/goals",{method:"POST",body:JSON.stringify(e)})},training:{getCourses:async()=>r("/training/courses"),enrollEmployee:async(e,t)=>r("/training/enroll",{method:"POST",body:JSON.stringify({employee_id:e,course_id:t})}),getProgress:async e=>r("/training/progress/".concat(e)),markComplete:async(e,t)=>r("/training/complete",{method:"POST",body:JSON.stringify({employee_id:e,course_id:t})})},benefits:{getAll:async()=>r("/benefits"),enroll:async(e,t)=>r("/benefits/enroll",{method:"POST",body:JSON.stringify({employee_id:e,benefit_id:t})}),getEnrollments:async e=>r("/benefits/enrollments/".concat(e))},compliance:{getAudits:async()=>r("/compliance/audits"),createAudit:async e=>r("/compliance/audits",{method:"POST",body:JSON.stringify(e)}),getRegulations:async()=>r("/compliance/regulations"),trackCompliance:async e=>r("/compliance/track/".concat(e))},document:{getAll:async()=>r("/documents"),upload:async(e,t)=>{let a=new FormData;return a.append("file",e),a.append("category",t),r("/documents/upload",{method:"POST",body:a,headers:{Authorization:"Bearer ".concat(s())}})},download:async e=>r("/documents/".concat(e,"/download")),delete:async e=>r("/documents/".concat(e),{method:"DELETE"})},facialAttendance:{scanFace:async(e,t)=>r("/facial-attendance/scan",{method:"POST",body:JSON.stringify({image:e,employee_id:t})}),getAttendanceRecords:async e=>r("/facial-attendance/records?date=".concat(e)),getAttendanceSummary:async e=>r("/facial-attendance/summary?date=".concat(e)),getMissingAttendance:async e=>r("/facial-attendance/missing?date=".concat(e)),sendHRNotification:async e=>r("/facial-attendance/notify-hr",{method:"POST",body:JSON.stringify(e)}),recordPenalty:async e=>r("/facial-attendance/penalty",{method:"POST",body:JSON.stringify(e)}),getPenaltyHistory:async e=>r("/facial-attendance/penalty-history/".concat(e)),getSettings:async()=>r("/facial-attendance/settings"),updateSettings:async e=>r("/facial-attendance/settings",{method:"PUT",body:JSON.stringify(e)}),getTimeSlots:async()=>r("/facial-attendance/time-slots"),updateTimeSlots:async e=>r("/facial-attendance/time-slots",{method:"PUT",body:JSON.stringify({time_slots:e})}),exportReport:async(e,t,a)=>r("/facial-attendance/export?start_date=".concat(e,"&end_date=").concat(t,"&format=").concat(a))}},d={setAuthToken:e=>{localStorage.setItem("authToken",e)},removeAuthToken:()=>{localStorage.removeItem("authToken")},isAuthenticated:()=>null!==s(),formatError:e=>{if("string"==typeof e)return e;if("object"==typeof e&&null!==e){if("message"in e&&"string"==typeof e.message)return e.message;if("errors"in e){let t=Object.values(e.errors)[0];return Array.isArray(t)?t[0]:String(t)}}return"An unexpected error occurred"}}},2200:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),r=a(2115),n=a(2619),c=a.n(n),o=a(63),l=a(854),i=a(960);function d(){let{isAuthenticated:e,loading:t}=(0,l.A)(),{employees:a,loading:n,error:d,deleteEmployee:m,clearError:u}=(()=>{let[e,t]=(0,r.useState)({employees:[],loading:!1,error:null}),a=(0,r.useCallback)(async()=>{try{t(e=>({...e,loading:!0,error:null}));let e=await i.Rz.getAll();e.success&&e.data?t({employees:e.data,loading:!1,error:null}):t(t=>({...t,loading:!1,error:e.message||"Failed to fetch employees"}))}catch(e){t(t=>({...t,loading:!1,error:e instanceof Error?e.message:"An error occurred"}))}},[]),s=(0,r.useCallback)(async e=>{try{t(e=>({...e,loading:!0,error:null}));let a=await i.Rz.create(e);if(a.success&&a.data)return t(e=>({employees:[...e.employees,a.data],loading:!1,error:null})),{success:!0,data:a.data};return t(e=>({...e,loading:!1,error:a.message||"Failed to create employee"})),{success:!1,error:a.message||"Failed to create employee"}}catch(a){let e=a instanceof Error?a.message:"An error occurred";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},[]),n=(0,r.useCallback)(async(e,a)=>{try{t(e=>({...e,loading:!0,error:null}));let s=await i.Rz.update(e,a);if(s.success&&s.data)return t(t=>({employees:t.employees.map(t=>t.id===e?s.data:t),loading:!1,error:null})),{success:!0,data:s.data};return t(e=>({...e,loading:!1,error:s.message||"Failed to update employee"})),{success:!1,error:s.message||"Failed to update employee"}}catch(a){let e=a instanceof Error?a.message:"An error occurred";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},[]),c=(0,r.useCallback)(async e=>{try{t(e=>({...e,loading:!0,error:null}));let a=await i.Rz.delete(e);if(a.success)return t(t=>({employees:t.employees.filter(t=>t.id!==e),loading:!1,error:null})),{success:!0};return t(e=>({...e,loading:!1,error:a.message||"Failed to delete employee"})),{success:!1,error:a.message||"Failed to delete employee"}}catch(a){let e=a instanceof Error?a.message:"An error occurred";return t(t=>({...t,loading:!1,error:e})),{success:!1,error:e}}},[]),o=(0,r.useCallback)(async e=>{try{let t=await i.Rz.getById(e);if(t.success&&t.data)return{success:!0,data:t.data};return{success:!1,error:t.message||"Employee not found"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}},[]),l=(0,r.useCallback)(()=>{t(e=>({...e,error:null}))},[]);return(0,r.useEffect)(()=>{a()},[a]),{...e,fetchEmployees:a,createEmployee:s,updateEmployee:n,deleteEmployee:c,getEmployeeById:o,clearError:l}})(),y=(0,o.useRouter)(),[p,g]=(0,r.useState)(""),[x,h]=(0,r.useState)("all");(0,r.useEffect)(()=>{t||e||y.push("/th/login")},[e,t,y]);let f=a.filter(e=>{let t="".concat(e.first_name," ").concat(e.last_name).toLowerCase().includes(p.toLowerCase())||e.position.toLowerCase().includes(p.toLowerCase())||e.email.toLowerCase().includes(p.toLowerCase()),a="all"===x||e.department&&e.department.name===x;return t&&a}),b=async e=>{if(window.confirm("คุณแน่ใจหรือไม่ที่จะลบพนักงานคนนี้?")){let t=await m(e);t.success||alert("ไม่สามารถลบพนักงานได้: "+t.error)}};return t||n?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"กำลังโหลด..."})]})}):e?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(c(),{href:"/th/dashboard",className:"text-gray-600 hover:text-gray-900 transition-colors",children:"← กลับสู่แดชบอร์ด"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"จัดการพนักงาน"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"จัดการข้อมูลพนักงานทั้งหมด"})]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsx)(c(),{href:"/th/employees/add",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"เพิ่มพนักงานใหม่"})})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[d&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:d}),(0,s.jsx)("button",{onClick:u,className:"text-red-600 hover:text-red-800 underline",children:"ปิด"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm border p-6 mb-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ค้นหา"}),(0,s.jsx)("input",{type:"text",placeholder:"ค้นหาตามชื่อ, ตำแหน่ง, หรืออีเมล",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"แผนก"}),(0,s.jsx)("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:["all","ฝ่ายขาย","ฝ่าย IT","ฝ่ายบัญชี","ฝ่าย HR"].map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"ทุกแผนก":e},e))})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["รายชื่อพนักงาน (",f.length," คน)"]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"พนักงาน"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ตำแหน่ง"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"แผนก"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"อีเมล"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เบอร์โทร"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(e=>{var t;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,s.jsxs)("span",{className:"text-indigo-600 font-medium text-sm",children:[e.first_name[0],e.last_name[0]]})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e.position})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:(null==(t=e.department)?void 0:t.name)||"ไม่ระบุ"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e.phone})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"active"===e.status?"ทำงาน":"ไม่ทำงาน"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{className:"text-indigo-600 hover:text-indigo-900 transition-colors",children:"แก้ไข"}),(0,s.jsx)("button",{onClick:()=>b(e.id),className:"text-red-600 hover:text-red-900 transition-colors",children:"ลบ"})]})})]},e.id)})})]})})]}),0===f.length&&(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("div",{className:"text-gray-500 text-lg",children:"ไม่พบพนักงานที่ตรงกับเงื่อนไขการค้นหา"})})]})]}):null}},3084:(e,t,a)=>{Promise.resolve().then(a.bind(a,2200))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=3084)),_N_E=e.O()}]);